USE MASTER

DECLARE C CURSOR FOR 
SELECT SPID FROM SysProcesses A 
INNER JOIN SysDatabases B ON A.DBID = B.DBID 
WHERE a.status='sleeping' and B.dbid = 6

DECLARE @SPID INT 
DECLARE  @next_SPID INT 
DECLARE  @sSQL NVARCHAR(255) 

OPEN C 
FETCH NEXT FROM C INTO @SPID 

WHILE (@@FETCH_STATUS=0) 
BEGIN
      SELECT @sSQL = 'DBCC INPUTBUFFER  ( ' + CONVERT(NVARCHAR(30),@SPID)+ ')' 
      EXEC(@sSQL)
      PRINT @sSQL

      SELECT @sSQL = 'KILL ' + CONVERT(NVARCHAR(30),@SPID) 
      EXEC(@sSQL) 
      PRINT @sSQL 

    FETCH NEXT FROM C INTO @SPID 
END
DEALLOCATE C